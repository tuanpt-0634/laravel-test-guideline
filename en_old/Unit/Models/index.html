
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.3">
    
    
      
        <title>Testing Models - PHP Testing Guidelines</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1655a90d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#testing-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="PHP Testing Guidelines" class="md-header__button md-logo" aria-label="PHP Testing Guidelines">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PHP Testing Guidelines
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Testing Models
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/tuanpt-0634/laravel-test-guideline/tree/new-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="PHP Testing Guidelines" class="md-nav__button md-logo" aria-label="PHP Testing Guidelines">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    PHP Testing Guidelines
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/tuanpt-0634/laravel-test-guideline/tree/new-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Giới thiệu
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../01-why/" class="md-nav__link">
        Viết test để làm gì?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../02-testcase/" class="md-nav__link">
        Cơ bản về test case
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../03-phpunit/" class="md-nav__link">
        PHPUnit
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../04-code-coverage/" class="md-nav__link">
        Code Coverage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../05-test-doubles-and-di/" class="md-nav__link">
        Test Doubles và DI
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../06-mutation-testing/" class="md-nav__link">
        Mutation Testing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../07-laravel/" class="md-nav__link">
        Laravel
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../08-checklist/" class="md-nav__link">
        Checklist
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../09-references/" class="md-nav__link">
        Tài liệu khác
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" checked>
      
      <label class="md-nav__link" for="__nav_11">
        En old
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="En old" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          En old
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Conventions/" class="md-nav__link">
        Laravel Testing Conventions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Introduction/" class="md-nav__link">
        Introduction to Laravel Testing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Knowledge/" class="md-nav__link">
        Knowledge about Unit Testing
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11_4" type="checkbox" id="__nav_11_4" >
      
      <label class="md-nav__link" for="__nav_11_4">
        Integration
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Integration" data-md-level="2">
        <label class="md-nav__title" for="__nav_11_4">
          <span class="md-nav__icon md-icon"></span>
          Integration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Integration/Integration/" class="md-nav__link">
        Integration Tests
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11_5" type="checkbox" id="__nav_11_5" checked>
      
      <label class="md-nav__link" for="__nav_11_5">
        Unit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Unit" data-md-level="2">
        <label class="md-nav__title" for="__nav_11_5">
          <span class="md-nav__icon md-icon"></span>
          Unit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Common/" class="md-nav__link">
        Common Testing Rules
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Controllers/" class="md-nav__link">
        Testing Controllers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Middleware/" class="md-nav__link">
        Testing Middleware Classes
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Testing Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Testing Models
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#guide" class="md-nav__link">
    Guide
  </a>
  
    <nav class="md-nav" aria-label="Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-properties" class="md-nav__link">
    Configuration properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relations" class="md-nav__link">
    Relations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property-values" class="md-nav__link">
    Property values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    Events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-checks" class="md-nav__link">
    Additional checks.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Transformers/" class="md-nav__link">
        Testing Transformers and Presenters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Validation/" class="md-nav__link">
        Testing Validation Rules.
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      <label class="md-nav__link" for="__nav_12">
        Vn old
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Vn old" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Vn old
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Conventions/" class="md-nav__link">
        Laravel Testing Conventions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Introduction/" class="md-nav__link">
        Giới thiệu về Laravel Testing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Knowledge/" class="md-nav__link">
        Knowledge about Unit Testing
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12_4" type="checkbox" id="__nav_12_4" >
      
      <label class="md-nav__link" for="__nav_12_4">
        Integration
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Integration" data-md-level="2">
        <label class="md-nav__title" for="__nav_12_4">
          <span class="md-nav__icon md-icon"></span>
          Integration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Integration/Integration/" class="md-nav__link">
        Integration Tests
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12_5" type="checkbox" id="__nav_12_5" >
      
      <label class="md-nav__link" for="__nav_12_5">
        Unit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Unit" data-md-level="2">
        <label class="md-nav__title" for="__nav_12_5">
          <span class="md-nav__icon md-icon"></span>
          Unit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Unit/Common/" class="md-nav__link">
        Common Testing Rules
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Unit/Controllers/" class="md-nav__link">
        Testing Controllers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Unit/Middleware/" class="md-nav__link">
        Testing Middleware Classes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Unit/Models/" class="md-nav__link">
        Testing Models
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Unit/Transformers/" class="md-nav__link">
        Testing Transformers and Presenters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../vn_old/Unit/Validation/" class="md-nav__link">
        Testing Validation Rules.
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#guide" class="md-nav__link">
    Guide
  </a>
  
    <nav class="md-nav" aria-label="Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-properties" class="md-nav__link">
    Configuration properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relations" class="md-nav__link">
    Relations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property-values" class="md-nav__link">
    Property values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    Events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-checks" class="md-nav__link">
    Additional checks.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/tuanpt-0634/laravel-test-guideline/tree/new-docs/edit/master/docs/en_old/Unit/Models.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="testing-models">Testing Models<a class="headerlink" href="#testing-models" title="Permanent link">&para;</a></h1>
<p>Models are ones of mostly used classes in Laravel applications. And at the same time they are the most complicated
from all default components.</p>
<p>Depending on implementation, models might include validation, external services connection (e. g. ElasticSearch indexing),
property getters and various custom methods.</p>
<p>As far as models might be used in any part of application, they must be tested carefully.</p>
<h2 id="guide">Guide<a class="headerlink" href="#guide" title="Permanent link">&para;</a></h2>
<h3 id="configuration-properties">Configuration properties<a class="headerlink" href="#configuration-properties" title="Permanent link">&para;</a></h3>
<p>Any model includes some default configurations with public or protected properties. These properties might affect
application behaivor a lot, but they are the most easy to test.
You can simply assert return values of that property getters:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%;"><span></span><code><span style="color: #2838b0">public</span> <span style="color: #2838b0">function</span> <span style="color: #785840">test_contains_valid_fillable_properties</span><span style="color: #888888">()</span>
<span style="color: #888888">{</span>
    <span style="color: #b04040">$m</span> <span style="color: #666666">=</span> <span style="color: #2838b0">new</span> User<span style="color: #888888">();</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">([</span><span style="color: #b83838">&#39;name&#39;</span><span style="color: #888888">,</span> <span style="color: #b83838">&#39;email&#39;</span><span style="color: #888888">],</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">getFillable</span><span style="color: #888888">());</span>
<span style="color: #888888">}</span>
</code></pre></div>
<p>Following method tests must be included in tests:</p>
<ul>
<li><code>$fillable</code> -&gt; <code>getFillable()</code></li>
<li><code>$guarded</code> -&gt; <code>getGuarded()</code></li>
<li><code>$table</code> -&gt; <code>getTable()</code></li>
<li><code>$primaryKey</code> -&gt; <code>getKeyName()</code></li>
<li><code>$connection</code> -&gt; <code>getConnectionName()</code>: in case multiple connections exist.</li>
<li><code>$hidden</code> -&gt; <code>getHidden()</code></li>
<li><code>$visible</code> -&gt; <code>getVisible()</code></li>
<li><code>$casts</code> -&gt; <code>getCasts()</code>: note that method appends incrementing key.</li>
<li><code>$dates</code> -&gt; <code>getDates()</code>: note that method appends <code>[static::CREATED_AT, static::UPDATED_AT]</code>.</li>
<li><code>newCollection()</code>: assert collection is exact type. Use <code>assertEquals</code> on <code>get_class()</code> result, but not <code>assertInstanceOf</code>.</li>
</ul>
<p>It is fine to put all checks inside one test method, e. g. <code>test_model_configuration()</code></p>
<h3 id="relations">Relations<a class="headerlink" href="#relations" title="Permanent link">&para;</a></h3>
<p>Relations are defined as methods returning appropriate relation classes. In some cases relation may be defined
with custom foreign keys or additional query changes. The best way to test relation config is to assert values
on returned <code>Relation</code> instance.</p>
<p>In all default cases, any relations is being created with <code>$model-&gt;newQuery()</code> as builder instance. If not modified,
it can be simply asserted with <code>assertEquals</code></p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%;"><span></span><code><span style="color: #2838b0">public</span> <span style="color: #2838b0">function</span> <span style="color: #785840">test_user_relation</span><span style="color: #888888">()</span>
<span style="color: #888888">{</span>
    <span style="color: #b04040">$m</span> <span style="color: #666666">=</span> <span style="color: #2838b0">new</span> Post<span style="color: #888888">();</span>
    <span style="color: #b04040">$relation</span> <span style="color: #666666">=</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">user</span><span style="color: #888888">();</span>

    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertInstanceOf</span><span style="color: #888888">(</span>BelongsTo<span style="color: #666666">::</span><span style="color: #388038">class</span><span style="color: #888888">,</span> <span style="color: #b04040">$relation</span><span style="color: #888888">);</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;user_id&#39;</span><span style="color: #888888">,</span> <span style="color: #b04040">$relation</span><span style="color: #666666">-&gt;</span><span style="color: #388038">getForeignKey</span><span style="color: #888888">());</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;id&#39;</span><span style="color: #888888">,</span> <span style="color: #b04040">$relation</span><span style="color: #666666">-&gt;</span><span style="color: #388038">getOwnerKey</span><span style="color: #888888">());</span>
    <span style="color: #888888; font-style: italic">//...</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">newQuery</span><span style="color: #888888">(),</span> <span style="color: #b04040">$relation</span><span style="color: #666666">-&gt;</span><span style="color: #388038">getQuery</span><span style="color: #888888">());</span>
<span style="color: #888888">}</span>
</code></pre></div>
<p>Depending on relation type, following test asserts must be included:</p>
<ul>
<li><code>getQuery()</code>: assert query has not been modified or modified properly.</li>
<li><code>getForeignKey()</code>: any <code>HasOneOrMany</code> or <code>BelongsTo</code> relation, but key type differs (see documentaiton).</li>
<li><code>getQualifiedParentKeyName()</code>: in case of <code>HasOneOrMany</code> relation, there is no <code>getLocalKey()</code> method, so this one should be asserted.</li>
<li><code>getOwnerKey()</code>: <code>BelongsTo</code> relation and its extendings.</li>
<li><code>getQualifiedForeignPivotKeyName()</code>: <code>BelongsToMany</code> relation.</li>
<li><code>getQualifiedRelatedPivotKeyName()</code>: <code>BelongsToMany</code> relation.</li>
<li><code>getTable()</code>: <code>BelongsToMany</code> relation. Optional, because included in methods above.</li>
<li><code>getMorphType()</code>: any polymorphic relations.</li>
</ul>
<h3 id="property-values">Property values<a class="headerlink" href="#property-values" title="Permanent link">&para;</a></h3>
<p>Many models might include property mutators or getters. Those methods modify output in many cases including <code>__get</code> and
<code>toArray()</code> results.</p>
<p>There must be a test case, which makes assertion on all properties.
For such case, you can use <code>unguarded</code> helper or remove guards manually.</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%;"><span></span><code><span style="color: #2838b0">public</span> <span style="color: #2838b0">function</span> <span style="color: #785840">test_properties_have_valid_values</span><span style="color: #888888">()</span>
<span style="color: #888888">{</span>
    User<span style="color: #666666">::</span><span style="color: #388038">unguard</span><span style="color: #888888">();</span>

    <span style="color: #b04040">$initial</span> <span style="color: #666666">=</span> <span style="color: #888888">[</span>
        <span style="color: #b83838">&#39;name&#39;</span> <span style="color: #666666">=&gt;</span> <span style="color: #b83838">&#39;Jonh Doe&#39;</span><span style="color: #888888">,</span>
        <span style="color: #b83838">&#39;email&#39;</span> <span style="color: #666666">=&gt;</span> <span style="color: #b83838">&#39;jonh@example.com&#39;</span><span style="color: #888888">,</span>
    <span style="color: #888888">];</span>

    <span style="color: #b04040">$m</span> <span style="color: #666666">=</span> <span style="color: #2838b0">new</span> User<span style="color: #888888">(</span><span style="color: #b04040">$initial</span><span style="color: #888888">);</span>

    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #b04040">$initial</span><span style="color: #888888">,</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">setHidden</span><span style="color: #888888">([]),</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">attributesToArray</span><span style="color: #888888">());</span>
<span style="color: #888888">}</span>
</code></pre></div>
<p>In case any getter exists, values might be modified, so tests should cover such additions.
Use <code>getAttributeValue()</code> to make sure, getter is called and property, and call to getter itself to test different values.
As far as mutators might also exist, use <code>setRawAttributes</code> to set initial values to ignore any unexpected value changes.</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%;"><span></span><code><span style="color: #2838b0">public</span> <span style="color: #2838b0">function</span> <span style="color: #785840">test_status_getter</span><span style="color: #888888">()</span>
<span style="color: #888888">{</span>
    <span style="color: #b04040">$m</span> <span style="color: #666666">=</span> <span style="color: #2838b0">new</span> User<span style="color: #888888">();</span>
    <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">setRawAttributes</span><span style="color: #888888">([</span>
        <span style="color: #b83838">&#39;status&#39;</span> <span style="color: #666666">=&gt;</span> <span style="color: #444444">1</span><span style="color: #888888">,</span>
    <span style="color: #888888">]);</span>

    <span style="color: #888888; font-style: italic">// Test if getter is working.</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;enabled&#39;</span><span style="color: #888888">,</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">getAttributeValue</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;status&#39;</span><span style="color: #888888">));</span>

    <span style="color: #888888; font-style: italic">// Test getter logic with different values.</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;disabled&#39;</span><span style="color: #888888">,</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">getStatusAttribute</span><span style="color: #888888">(</span><span style="color: #444444">2</span><span style="color: #888888">));</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;pending&#39;</span><span style="color: #888888">,</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">getStatusAttribute</span><span style="color: #888888">(</span><span style="color: #444444">3</span><span style="color: #888888">));</span>

    <span style="color: #888888; font-style: italic">// Abnormal case</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">expectException</span><span style="color: #888888">(</span>\InvalidArgumentException<span style="color: #666666">::</span><span style="color: #388038">class</span><span style="color: #888888">);</span>
    <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">getStatusAttribute</span><span style="color: #888888">(</span><span style="color: #444444">4</span><span style="color: #888888">);</span>
<span style="color: #888888">}</span>
</code></pre></div>
<p>Same rules apply to mutators. In order to avoid any getters applied, use <code>getAttributes()</code> method for assertions.</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%;"><span></span><code><span style="color: #2838b0">public</span> <span style="color: #2838b0">function</span> <span style="color: #785840">test_status_getter</span><span style="color: #888888">()</span>
<span style="color: #888888">{</span>
    <span style="color: #b04040">$m</span> <span style="color: #666666">=</span> <span style="color: #2838b0">new</span> User<span style="color: #888888">();</span>

    <span style="color: #888888; font-style: italic">// Test if mutator is working.</span>
    <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">setAttribute</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;status&#39;</span><span style="color: #888888">,</span> <span style="color: #b83838">&#39;enabled&#39;</span><span style="color: #888888">);</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #444444">1</span><span style="color: #888888">,</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">getAttributes</span><span style="color: #888888">()[</span><span style="color: #b83838">&#39;status&#39;</span><span style="color: #888888">]);</span>

    <span style="color: #888888; font-style: italic">// Test mutator logic with different values.</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #444444">2</span><span style="color: #888888">,</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">setStatusAttribute</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;disabled&#39;</span><span style="color: #888888">);</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">assertEquals</span><span style="color: #888888">(</span><span style="color: #444444">3</span><span style="color: #888888">,</span> <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">setStatusAttribute</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;pending&#39;</span><span style="color: #888888">);</span>

    <span style="color: #888888; font-style: italic">// Abnormal case</span>
    <span style="color: #b04040">$this</span><span style="color: #666666">-&gt;</span><span style="color: #388038">expectException</span><span style="color: #888888">(</span>\InvalidArgumentException<span style="color: #666666">::</span><span style="color: #388038">class</span><span style="color: #888888">);</span>
    <span style="color: #b04040">$m</span><span style="color: #666666">-&gt;</span><span style="color: #388038">setStatusAttribute</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;invalid_status&#39;</span><span style="color: #888888">);</span>
<span style="color: #888888">}</span>
</code></pre></div>
<h3 id="events">Events<a class="headerlink" href="#events" title="Permanent link">&para;</a></h3>
<p>Model includes protected static <code>$dispatcher</code> property, which stores application event handler. If your model
uses internal events or observers, make sure that proper listeners are assigned by mocking dispatcher class.</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%;"><span></span><code><span style="color: #2838b0">public</span> <span style="color: #2838b0">function</span> <span style="color: #785840">test_listeners_attached</span><span style="color: #888888">()</span>
<span style="color: #888888">{</span>
    <span style="color: #b04040">$d</span> <span style="color: #666666">=</span> m<span style="color: #666666">::</span><span style="color: #388038">mock</span><span style="color: #888888">(</span>\Illuminate\Contracts\Events\Dispatcher<span style="color: #666666">::</span><span style="color: #388038">class</span><span style="color: #888888">);</span>
    User<span style="color: #666666">::</span><span style="color: #388038">setEventDispatcher</span><span style="color: #888888">(</span><span style="color: #b04040">$d</span><span style="color: #888888">);</span>
    <span style="color: #b04040">$name</span> <span style="color: #666666">=</span> User<span style="color: #666666">::</span><span style="color: #388038">class</span><span style="color: #888888">;</span>

    <span style="color: #888888; font-style: italic">// Assert that created event has been assigned. Include additional checks if needed.</span>
    <span style="color: #b04040">$d</span><span style="color: #666666">-&gt;</span><span style="color: #388038">shouldReceive</span><span style="color: #888888">(</span><span style="color: #b83838">&#39;listen&#39;</span><span style="color: #888888">)</span><span style="color: #666666">-&gt;</span><span style="color: #388038">once</span><span style="color: #888888">()</span><span style="color: #666666">-&gt;</span><span style="color: #388038">with</span><span style="color: #888888">(</span><span style="color: #b83838">&quot;eloquent.created: </span><span style="color: #b83838; text-decoration: underline">{</span><span style="color: #b04040">$name</span><span style="color: #b83838; text-decoration: underline">}</span><span style="color: #b83838">&quot;</span><span style="color: #888888">,</span> m<span style="color: #666666">::</span><span style="color: #388038">any</span><span style="color: #888888">());</span>

    User<span style="color: #666666">::</span><span style="color: #388038">boot</span><span style="color: #888888">();</span>
<span style="color: #888888">}</span>
</code></pre></div>
<blockquote>
<p>Do not use <code>Dispather::hasListeners()</code> method, because events might be assigned from anywhere in the application.
Purpose of this test is to make sure that events have been assigned inside the model.</p>
</blockquote>
<p>Testing of observers should follow the same approach as for testing any usual classes.
While event handlers, attached during boot can be accessed via <code>getListeners()</code> method of event dispatcher.
However it is highly recommended not to use such assignments and use observers instead.</p>
<h3 id="additional-checks">Additional checks.<a class="headerlink" href="#additional-checks" title="Permanent link">&para;</a></h3>
<p>All additional methods and configurations must be tested if present, including but not limited to:</p>
<ul>
<li>Custom model methods.</li>
<li>Usage of traits.</li>
<li>Custom <code>CREATED_AT</code> and <code>UPDATED_AT</code> keys.</li>
<li><code>$with</code> property if set.</li>
<li><code>$incrementing</code> property if changed by default.</li>
<li><code>$dateFormat</code> property if changed by default.</li>
</ul>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/framgia/laravel-test-examples/blob/master/tests/ModelTestCase.php">Example abstract model test helper</a></li>
<li><a href="https://github.com/framgia/laravel-test-examples/blob/master/app/City.php">Example model</a> and <a href="https://github.com/framgia/laravel-test-examples/blob/master/tests/Unit/CityTest.php">test</a></li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../Middleware/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Testing Middleware Classes
            </div>
          </div>
        </a>
      
      
        <a href="../Transformers/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Testing Transformers and Presenters
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ca5457b8.min.js"></script>
      
    
  </body>
</html>